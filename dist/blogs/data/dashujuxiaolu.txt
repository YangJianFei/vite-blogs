/*
title:大数据量分页存储过程效率测试附代码
date:2020-04-08
keyword:分页存储,高效率,
*/

<div id="cnblogs_post_body" class="blogpost-body blogpost-body-html">
<p class="highlighter">在项目中，我们经常遇到或用到分页，那么在大数据量（百万级以上）下，哪种分页算法效率最优呢？我们不妨用事实说话。</p>
<p>&nbsp;</p>
<p>测试环境</p>
<p>硬件：CPU 酷睿双核T5750&nbsp; 内存：2G</p>
<p>软件:Windows server 2003&nbsp;&nbsp;&nbsp; +&nbsp;&nbsp; Sql server 2005</p>
<p>&nbsp;</p>
<p>OK,我们首先创建一数据库：data_Test,并在此数据库中创建一表：tb_TestTable</p>
<p class="highlighter">&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">database</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;data_Test&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">创建数据库data_Test&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">GO</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">use</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;data_Test&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">GO</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">table</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;tb_TestTable&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">创建表&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;id&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">identity</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">primary</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">key</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;userName&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">not</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;userPWD&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">not</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;userEmail&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">40</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">GO</span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p class="highlighter">&nbsp;</p>
<p class="alt"><font color="#000000">然后我们在数据表中插入2000000条数据:</font></p>
<p class="highlighter">&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">插入数据&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">identity_insert</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;tb_TestTable&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">on</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">while</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">&lt;=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2000000</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">insert</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">into</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;tb_TestTable(id,userName,userPWD,userEmail)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">values</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">admin</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">admin888</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">lli0077@yahoo.com.cn</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">identity_insert</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;tb_TestTable&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">off</span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p class="highlighter">&nbsp;</p>
<p class="alt"><font color="#000000">我首先写了五个常用存储过程：</font></p>
<p class="alt"><font color="#000000">1，利用select top 和select not in进行分页，具体代码如下：</font></p>
<font color="#000000">
<p class="highlighter">&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">procedure</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;proc_paged_with_notin&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">利用select&nbsp;top&nbsp;and&nbsp;select&nbsp;not&nbsp;in&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">页索引&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">每页记录数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">on</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">datetime</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">耗时&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">500</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">Getdate</span><span style="color: rgba(0, 0, 0, 1)">()&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">select&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;tb_TestTable&nbsp;where(ID&nbsp;not&nbsp;in(select&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;id&nbsp;from&nbsp;tb_TestTable&nbsp;order&nbsp;by&nbsp;ID&nbsp;ASC))&nbsp;order&nbsp;by&nbsp;ID</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">13</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">execute</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">因select&nbsp;top后不支技直接接参数，所以写成了字符串@sql&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">14</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">datediff</span><span style="color: rgba(0, 0, 0, 1)">(ms,</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 255, 1)">GetDate</span><span style="color: rgba(0, 0, 0, 1)">())&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;耗时&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">15</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">off</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p class="highlighter">&nbsp;</p>
<p>2,利用select top 和 select max(列键)</p>
<p class="highlighter">&nbsp;</p>
<p>&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">procedure</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;proc_paged_with_selectMax&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">利用select&nbsp;top&nbsp;and&nbsp;select&nbsp;max(列)&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">页索引&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">页记录数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">on</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">datetime</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">500</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">Getdate</span><span style="color: rgba(0, 0, 0, 1)">()&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">select&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;From&nbsp;tb_TestTable&nbsp;where(ID&gt;(select&nbsp;max(id)&nbsp;From&nbsp;(select&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;id&nbsp;From&nbsp;tb_TestTable&nbsp;order&nbsp;by&nbsp;ID)&nbsp;as&nbsp;TempTable))&nbsp;order&nbsp;by&nbsp;ID</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">13</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">execute</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">14</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">datediff</span><span style="color: rgba(0, 0, 0, 1)">(ms,</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 255, 1)">GetDate</span><span style="color: rgba(0, 0, 0, 1)">())&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;耗时&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">15</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">off</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p>&nbsp;</p>
<p>3,利用select top和中间变量--此方法因网上有人说效果最佳，所以贴出来一同测试</p>
<div class="highlighter"></div>
<p>&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">procedure</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;proc_paged_with_Midvar&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">利用ID&gt;最大ID值和中间变量&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">datetime</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">500</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">on</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">13</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">getdate</span><span style="color: rgba(0, 0, 0, 1)">()&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">14</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">case</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">when</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@count</span><span style="color: rgba(128, 128, 128, 1)">&lt;=</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">then</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;ID&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">from</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;tb_testTable&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">order</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">by</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;id&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">15</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">select&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;tb_testTable&nbsp;where&nbsp;ID&gt;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">execute</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@sql</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">17</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">datediff</span><span style="color: rgba(0, 0, 0, 1)">(ms,</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 255, 1)">getdate</span><span style="color: rgba(0, 0, 0, 1)">())&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;耗时&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">18</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">off</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">19</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">20</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p>&nbsp;</p>
<p>4,利用Row_number() 此方法为SQL server 2005中新的方法,利用Row_number()给数据行加上索引</p>
<p>&nbsp;</p>
<div class="highlighter"></div>
<p>&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">procedure</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;proc_paged_with_Rownumber&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">利用SQL&nbsp;2005中的Row_number()&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">datetime</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">on</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">getdate</span><span style="color: rgba(0, 0, 0, 1)">()&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">from</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;(</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">,Row_number()&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">over</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 0, 255, 1)">order</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">by</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;ID&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">asc</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;IDRank&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">from</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;tb_testTable)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;IDWithRowNumber&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">where</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;IDRank</span><span style="color: rgba(128, 128, 128, 1)">&gt;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">and</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;IDRank</span><span style="color: rgba(128, 128, 128, 1)">&lt;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">datediff</span><span style="color: rgba(0, 0, 0, 1)">(ms,</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 255, 1)">getdate</span><span style="color: rgba(0, 0, 0, 1)">())&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;耗时&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">13</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">off</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">14</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">15</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p>5，利用临时表及Row_number</p>
<div class="highlighter"></div>
<p>&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 0, 255, 1)">create</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">procedure</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;proc_CTE&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">利用临时表及Row_number&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;3</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">页索引&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;4</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">页记录数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;5</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">on</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;8</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ctestr</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">400</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;9</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSql</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">400</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">10</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@datediff</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">datetime</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">11</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">12</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@datediff</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">GetDate</span><span style="color: rgba(0, 0, 0, 1)">()&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">13</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ctestr</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">with&nbsp;Table_CTE&nbsp;as&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">14</span><span style="color: rgba(255, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(select&nbsp;ceiling((Row_number()&nbsp;over(order&nbsp;by&nbsp;ID&nbsp;ASC))/</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;as&nbsp;page_num,*&nbsp;from&nbsp;tb_TestTable)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">15</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSql</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@ctestr</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;select&nbsp;*&nbsp;From&nbsp;Table_CTE&nbsp;where&nbsp;page_num=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 255, 1)">str</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">16</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">17</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">18</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">execute</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;sp_executesql&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSql</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">19</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">datediff</span><span style="color: rgba(0, 0, 0, 1)">(ms,</span><span style="color: rgba(0, 128, 0, 1)">@datediff</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 255, 1)">GetDate</span><span style="color: rgba(0, 0, 0, 1)">())&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">20</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;nocount&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">off</span><span style="color: rgba(0, 0, 0, 1)">;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">21</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">22</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p>&nbsp;</p>
<p>OK,至此，存储过程创建完毕，我们分别在每页10条数据的情况下在第2页，第1000页，第10000页，第100000页，第199999页进行测试，耗时单位：ms&nbsp; 每页测试5次取其平均值</p>
<p>
</p><div class="table-wrapper"><table style="width: 100%" cellspacing="1" cellpadding="1" align="center" border="1">
    <tbody><tr>
            <td>存过</td>
            <td>第2页耗时</td>
            <td>第1000页耗时</td>
            <td>第10000页耗时</td>
            <td>第100000页耗时</td>
            <td>第199999页耗时</td>
            <td>效率排行</td>
        </tr>
        <tr>
            <td>1用not in</td>
            <td>0ms</td>
            <td>16ms</td>
            <td>47ms</td>
            <td>475ms</td>
            <td>953ms</td>
            <td>3</td>
        </tr>
        <tr>
            <td>2用select max</td>
            <td>5ms</td>
            <td>16ms</td>
            <td>35ms</td>
            <td>325ms</td>
            <td>623ms</td>
            <td>1</td>
        </tr>
        <tr>
            <td>3中间变量</td>
            <td>966ms</td>
            <td>970ms</td>
            <td>960ms</td>
            <td>945ms</td>
            <td>933ms</td>
            <td>5</td>
        </tr>
        <tr>
            <td>4row_number</td>
            <td>0ms</td>
            <td>0ms</td>
            <td>34ms</td>
            <td>365ms</td>
            <td>710ms</td>
            <td>2</td>
        </tr>
        <tr>
            <td>4临时表</td>
            <td>780ms</td>
            <td>796ms</td>
            <td>798ms</td>
            <td>780ms</td>
            <td>805ms</td>
            <td>4</td>
        </tr>
    </tbody></table></div>
<p></p>
<p>&nbsp;</p>
<p>测试结果显示：select max &gt;row_number&gt;not in&gt;临时表&gt;中间变量</p>
<p>&nbsp;</p>
<p>于是我对效率最高的select max方法用2分法进行了扩展，代码取自互联网，我修改了ASC排序时取不到值的BUG，测试结果:</p>
<p>
</p><div class="table-wrapper"><table style="width: 100%" cellspacing="1" cellpadding="1" border="1">
    <tbody><tr>
            <td>2分法</td>
            <td>156ms</td>
            <td>156ms</td>
            <td>180ms</td>
            <td>470ms</td>
            <td>156ms</td>
            <td>1*</td>
        </tr>
    </tbody></table></div>
<p></p>
</font><p><font color="#000000"></font>&nbsp;</p>
<p>从测试结果来看，使用2分法确实可以提高效率并使效率更为稳定，我又增加了第159999页的测试，用时仅296ms，效果相当的不错！</p>
<p>&nbsp;</p>
<p>下面是2分法使用select max的代码，已相当完善。</p>
<div class="highlighter"></div>
<p>&nbsp;</p>
<div class="cnblogs_code"><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;1</span><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">/*-----存储过程&nbsp;分页处理&nbsp;孙伟&nbsp;2005-03-28创建&nbsp;-------*/&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;2</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">--</span><span style="color: rgba(0, 128, 128, 1)">/*-----存储过程&nbsp;分页处理&nbsp;浪尘&nbsp;2008-9-1修改----------*/&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;3</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">--</span><span style="color: rgba(0, 128, 128, 1)">/*-----&nbsp;对数据进行了2分处理使查询前半部分数据与查询后半部分数据性能相同&nbsp;-------*/&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;4</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;5</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">alter</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">PROCEDURE</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;proc_paged_2part_selectMax&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;6</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">(&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;7</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--要显示的表或多个表的连接&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;8</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">500</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">*</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--要显示的字段列表&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;&nbsp;9</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--每页显示的记录个数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;10</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--要显示那一页的记录&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;11</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">200</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--排序字段列表或条件&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;12</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@Sort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">bit</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--排序方法，0为升序，1为降序(如果是多字段排列Sort指代最后一个排序字段的排列顺序(最后一个排序字段不加排序标记)--程序传参如：'&nbsp;SortA&nbsp;Asc,SortB&nbsp;Desc,SortC&nbsp;')&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;13</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--查询条件,不需where&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;14</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">150</span><span style="color: rgba(0, 0, 0, 1)">),&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--主表的主键&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;15</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@Dist</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">bit</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--是否添加查询字段的&nbsp;DISTINCT&nbsp;默认0不添加/1添加&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;16</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@pageCount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;output,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--查询结果分页后的总页数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;17</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 0, 1)">@Counts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;output&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--查询到的记录数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;18</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;19</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">AS</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;20</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">SET</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;NOCOUNT&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">ON</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;21</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sqlTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--存放动态生成的SQL语句&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;22</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--存放取得查询结果总数的查询语句&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;23</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1000</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--存放取得查询开头或结尾ID的查询语句&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;24</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;25</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--数据排序规则A&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;26</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">10</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--数据排序规则B&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;27</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;28</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">50</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--对含有DISTINCT的查询进行SQL构造&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;29</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">Declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlCounts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">nvarchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">50</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--对含有DISTINCT的总数查询进行SQL构造&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;30</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;31</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">datetime</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">耗时测试时间差&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;32</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 255, 1)">getdate</span><span style="color: rgba(0, 0, 0, 1)">()&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;33</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;34</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@Dist</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;35</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;36</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">select&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;37</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlCounts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">Count(*)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;38</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;39</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;40</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;41</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">select&nbsp;distinct&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;42</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlCounts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">Count(DISTINCT&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;43</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;44</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;45</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;46</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@Sort</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;47</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;48</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;ASC&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;49</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;DESC&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;50</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;51</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;52</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;53</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;DESC&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;54</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;ASC&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;55</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;56</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;57</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;58</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;59</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">------生成查询语句--------&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;60</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">--</span><span style="color: rgba(0, 128, 128, 1)">此处@strTmp为取得查询结果数量的语句&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;61</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">is</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">or</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">''</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">没有设置显示条件&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;62</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;63</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sqlTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;From&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;64</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;@Counts=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlCounts</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;FROM&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;65</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;From&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;66</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;67</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;68</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;69</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@sqlTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">From&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1&gt;0)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;70</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;@Counts=</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlCounts</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;FROM&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1&gt;0)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;71</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;From&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1&gt;0)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;72</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;73</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;74</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">--取得查询结果总数量-----&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;75</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">exec</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;sp_executesql&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(0, 0, 0, 1)">,N</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">@Counts&nbsp;int&nbsp;out&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(0, 128, 0, 1)">@Counts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;out&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;76</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tmpCounts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;77</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@Counts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;78</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tmpCounts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;79</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;80</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tmpCounts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@Counts</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;81</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;82</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">取得分页总数&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;83</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageCount</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@tmpCounts</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">/</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;84</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;85</span><span style="color: rgba(0, 0, 0, 1)"><img id="Codehighlighter1_2564_2568_Open_Image" src="https://www.cnblogs.com/Images/OutliningIndicators/ExpandedBlockStart.gif" align="top"><img id="Codehighlighter1_2564_2568_Closed_Image" style="display: none" src="https://www.cnblogs.com/Images/OutliningIndicators/ContractedBlock.gif" align="top">&nbsp;&nbsp;&nbsp;&nbsp;</span><span id="Codehighlighter1_2564_2568_Closed_Text" style="border: 1px solid rgba(128, 128, 128, 1); display: none; background-color: rgba(255, 255, 255, 1)">/**/</span><span id="Codehighlighter1_2564_2568_Open_Text"><span style="color: rgba(0, 128, 128, 1)">/**/</span></span><span id="Codehighlighter1_2568_2588_Closed_Text" style="border: 1px solid rgba(128, 128, 128, 1); display: none; background-color: rgba(255, 255, 255, 1)">/**/</span><span id="Codehighlighter1_2568_2588_Open_Text"><span style="color: rgba(0, 128, 128, 1)">/*</span><span style="color: rgba(0, 128, 128, 1)">*当前页大于总页数&nbsp;取最后一页*</span><span style="color: rgba(0, 128, 128, 1)">*/</span></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;86</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">&gt;</span><span style="color: rgba(0, 128, 0, 1)">@pageCount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;87</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@pageCount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;88</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;89</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">/*-----数据分页2分处理-------*/&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;90</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">总数/页大小&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;91</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">declare</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">int</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">总数%页大小&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;92</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;93</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tmpCounts</span><span style="color: rgba(128, 128, 128, 1)">/</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;94</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@tmpCounts</span><span style="color: rgba(128, 128, 128, 1)">%</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;95</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">&gt;</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">0</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;96</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;97</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;98</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pagesize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">&nbsp;99</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">100</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">//***显示分页&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">101</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">is</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">null</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">or</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(255, 0, 0, 1)">''</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">没有设置显示条件&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">102</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">103</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(128, 128, 128, 1)">&lt;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">or</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">&lt;=</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">/</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">%</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">前半部分数据处理&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">104</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">105</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">106</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">107</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">108</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">109</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">110</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@Sort</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">111</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">112</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">113</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&lt;(select&nbsp;min(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">114</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMinID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">115</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">116</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">117</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">118</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">119</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">120</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&gt;(select&nbsp;max(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">121</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMinID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">122</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">123</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">124</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">125</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">126</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">127</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">128</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">后半部分数据处理&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">129</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">&lt;=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">最后一页数据显示&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">130</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">131</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TempTB</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">132</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">133</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@Sort</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">134</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">135</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">136</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&gt;(select&nbsp;max(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">137</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMaxID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">138</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TempTB</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">139</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">140</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">141</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">142</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">143</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&lt;(select&nbsp;min(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">144</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMaxID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">145</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TempTB</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">146</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">147</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">148</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">149</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">150</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">有查询条件&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">151</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">152</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(128, 128, 128, 1)">&lt;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">or</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">&lt;=</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">/</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">%</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">前半部分数据处理&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">153</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">154</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">155</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">156</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;1=1&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">157</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@Sort</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">158</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">159</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">160</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&lt;(select&nbsp;min(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">161</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1=1)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMinID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">162</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">163</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">164</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">165</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">166</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">167</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&gt;(select&nbsp;max(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">168</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1=1)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMinID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">169</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">170</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">171</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">172</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">173</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">begin</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">174</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@pageIndex</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">后半部分数据处理&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">175</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">&lt;=</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">最后一页数据显示&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">176</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">177</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1=1)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TempTB</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">178</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">if</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@Sort</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">1</span><span style="color: rgba(0, 0, 0, 1)">)&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">179</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">180</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&gt;(select&nbsp;max(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">181</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1=1)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMaxID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">182</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TempTB</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">183</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">else</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">184</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">set</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(128, 128, 128, 1)">=</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;*&nbsp;from&nbsp;(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">VARCHAR</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">4</span><span style="color: rgba(0, 0, 0, 1)">))</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldName</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">185</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;&lt;(select&nbsp;min(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;from(</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@SqlSelect</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;top&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">CAST</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@pageSize</span><span style="color: rgba(128, 128, 128, 1)">*</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="color: rgba(0, 128, 0, 1)">@page</span><span style="color: rgba(128, 128, 128, 1)">-</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">2</span><span style="color: rgba(0, 0, 0, 1)">)</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@lastcount</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">Varchar</span><span style="color: rgba(0, 0, 0, 1)">(</span><span style="font-weight: bold; color: rgba(128, 0, 0, 1)">20</span><span style="color: rgba(0, 0, 0, 1)">))&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@ID</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;from&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 128, 0, 1)">@tblName</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">186</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;where&nbsp;(1=1)&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TBMaxID)</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">187</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strCondition</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strSortType</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">)&nbsp;AS&nbsp;TempTB</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;order&nbsp;by&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@fldSort</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(255, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 0, 1)">'</span><span style="color: rgba(128, 128, 128, 1)">+</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strFSortType</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">188</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">189</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt="">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">end</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">190</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""><br>
</span><span style="color: rgba(0, 128, 128, 1)">191</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">----返回查询结果-----&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">192</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">exec</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;sp_executesql&nbsp;</span><span style="color: rgba(0, 128, 0, 1)">@strTmp</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">193</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">select</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;</span><span style="color: rgba(255, 0, 255, 1)">datediff</span><span style="color: rgba(0, 0, 0, 1)">(ms,</span><span style="color: rgba(0, 128, 0, 1)">@timediff</span><span style="color: rgba(0, 0, 0, 1)">,</span><span style="color: rgba(255, 0, 255, 1)">getdate</span><span style="color: rgba(0, 0, 0, 1)">())&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">as</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;耗时&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">194</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 128, 128, 1)">--</span><span style="color: rgba(0, 128, 128, 1)">print&nbsp;@strTmp&nbsp;</span><span style="color: rgba(0, 128, 128, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">195</span><span style="color: rgba(0, 128, 128, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">SET</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;NOCOUNT&nbsp;</span><span style="color: rgba(0, 0, 255, 1)">OFF</span><span style="color: rgba(0, 0, 0, 1)">&nbsp;<br>
</span><span style="color: rgba(0, 128, 128, 1)">196</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><span style="color: rgba(0, 0, 255, 1)">GO</span><span style="color: rgba(0, 0, 0, 1)"><br>
</span><span style="color: rgba(0, 128, 128, 1)">197</span><span style="color: rgba(0, 0, 0, 1)"><img src="https://www.cnblogs.com/Images/OutliningIndicators/None.gif" align="top" alt=""></span><div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a href="javascript:void(0);" onclick="copyCnblogsCode(this)" title="复制代码"><img src="//common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></span></div></div>
<p>&nbsp;</p>
<p>执行示例：exec proc_paged_2part_selectMax 'tb_testTable','ID,userName,userPWD,userEmail',10,100000,'ID',0,null,'ID',0</p>
<p>&nbsp;</p>
<p>这种测试只在单机进行，并且没有在实际开发WEB项目中分页测试，测试项也比较单一，所以不够全面系统，但从其效率相比上，我们可以在数据库分页算法上进行有效的控制。</p>
 
</div>